Тестовое задание для Maxbitsolution.
 На позицию Machine learning engineer.

 Цель:

-   построить DL модель для классификации состояния дерева
    (Good/Fair/Poor) по данным из NY street tree 2015.

Данные находятся в каталоге - data на Гугл диске https://drive.google.com/drive/folders/1Zhm0sJyTSZpusPKRnWFRm7jOOF8MiUAk

-   2015-street-tree-census-tree-data.csv - исходный датасет.
-   train.csv - очищенные данные для тренировки.
-   test.csv - очищеные данные для проверки модели.

Ноутбуки для подготовки и обучения:

-   eda_ny_tree.ipynb - exploratory data analysis и очистка данных.
-   baseline.ipynb - трансформация данных и модель градиентного бустинга
    из пакета sklearn.
-   tabnn.ipynb - DL модель на Pytorch.

Файлы моделей:

-   tabularnn_model.pth - модель Pytorch.
-   scaler.pkl и encoder.pkl - данный для предпроцессинга.

Файл app.py представляет собой реализацию API на FastApi.

Запуск.
Для запуска используется unicorn:
```bash
uvicorn app:app --reload
```
Можно протестировать API используя curl или Postman
```
curl -X POST "http://127.0.0.1:8000/predict" \
-H "Content-Type: application/json" \
-d '{"root_stone": "Yes", "root_grade": "No", "root_other": "No", "trunk_wire": "No", "trnk_ligth": "No", "trnk_other": "No", "brch_light": "Yes", "brch_shoe": "No", "brch_other": "No", "curb_loc": "OnCurb", "sidewalk": "Damage", "spc_common":  "honeylocust", "nta": "BK26", "tree_dbh": 15}
```
Ответ:
```json
{
  "prediction": 'Good'
}
```

Модель входных данных:

Класс InputData определяет структуру входных данных с использованием
BaseModel от Pydantic.

Предварительная обработка:

Входные данные предварительно обрабатываются (Encoding, Scaling) перед
передачей в модель.

Прогноз:

Модель делает прогноз, и результат возвращается в виде ответа JSON.

Обработка ошибок:

Если возникает ошибка (например, неверный ввод), возвращается ошибка
HTTP 400 с подробной информацией.

Модель TabularNN

Embedding

Категориальные признаки передаются через слои внедрения для
преобразования их в плотные векторы.

Конкатенация

Встроенные категориальные признаки и числовые признаки объединяются в
один входной тензор.

Линейные слои

Объединенные объекты передаются через полностью связанные слои для
составления прогнозов.

Обучение

Так как выходных классов 3, используется для обучения
nn.CrossEntropyLoss

Такая архитектура выбрана потому, что позволяет использовать и
категориальные и числовые данные, за которыми идет простой перцептрон.

Выводы

-   Модель достигает точности 0.8106 или 81%.
-   Имеется возможность дальнейшего исследования модели, для роста
    точности.
